SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("bejuco.txt", encoding = 'UTF-8')
Species$habit <- 'L'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("epifito.txt", encoding = 'UTF-8')
Species$habit <- 'E.F'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("hemiepifito.txt", encoding = 'UTF-8')
Species$habit <- 'E.hemi'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("hierba.txt", encoding = 'UTF-8')
Species$habit <- 'H'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("parasito.txt", encoding = 'UTF-8')
Species$habit <- '.i'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("subarbusto.txt", encoding = 'UTF-8')
Species$habit <- 'S1'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("suculento.txt", encoding = 'UTF-8')
Species$habit <- '.U'
SpeciesHabits <- rbind(SpeciesHabits, Species)
#Species<- read.delim("terrestre.txt", encoding = 'UTF-8')
#Species$habit <- '.terrestre'
#SpeciesHabits <- rbind(SpeciesHabits, Species)
#Species<- read.delim("trepadora.txt", encoding = 'UTF-8')
#Species$habit <- 'L.trailing'
#SpeciesHabits <- rbind(SpeciesHabits, Species)
####----
NA_Flora <- read.delim("NA_Flora.txt", encoding = 'UTF-8')
Habit_Symbols <- read.delim("Habit_Symbols.txt", encoding = 'UTF-8')
SpeciesHabits$split <- paste(str_split_fixed(SpeciesHabits$Name, " ",3)[,1],str_split_fixed(SpeciesHabits$Name , " ",3)[,2])
SpeciesHabits$auth <- str_split_fixed(SpeciesHabits$Name, " ",3)[,3]
SpeciesHabits$second <- str_split_fixed(SpeciesHabits$Name , " ",3)[,2]
SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1)) == substr(SpeciesHabits$second,1,1),]$split <-
str_split_fixed(SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1))
== substr(SpeciesHabits$second,1,1),]$Name, " ",3)[,1]
SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1)) == substr(SpeciesHabits$second,1,1),]$auth <-
str_split_fixed(SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1)) == substr(SpeciesHabits$second,1,1),]$
Name, " ",2)[,2]
SpeciesHabits[SpeciesHabits$second == '×',]$split <-
paste(str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name, " ",4)[,1],
str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name , " ",4)[,2],
str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name, " ",4)[,3])
SpeciesHabits[SpeciesHabits$second == '×',]$auth <-
str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name, " ",4)[,4]
SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$split <-
paste(str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name, " ",5)[,1],
str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name , " ",5)[,2],
str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name , " ",5)[,3],
str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name , " ",5)[,4])
SpeciesHabits[grepl('sp\\.',SpeciesHabits$Name),]$auth <-
str_split_fixed(SpeciesHabits[grepl('sp\\.',SpeciesHabits$Name),]$Name, " ",5)[,5]
SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$split <-
paste(str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name, " ",5)[,1],
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name , " ",5)[,2],
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name , " ",5)[,3],
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name , " ",5)[,4])
SpeciesHabits[grepl(' var\\.',SpeciesHabits$Name),]$auth <-
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name, " ",5)[,5]
####----Crosstab
SpeciesHabits$a <- 1
SpeciesHabits2 <- unique(SpeciesHabits[,c('split','auth')])
forma <- unique(SpeciesHabits$habit)
for (i in 1:length(forma)){
SpeciesHabits2 <- merge(SpeciesHabits2, SpeciesHabits[SpeciesHabits$habit %in% forma[i],c('split','auth','a')], by=c('split','auth'), all.x = TRUE)
SpeciesHabits2$new <- 0
SpeciesHabits2[!is.na(SpeciesHabits2$a),]$new <- 1
colnames(SpeciesHabits2)[colnames(SpeciesHabits2)=="new"] <- forma[i]
SpeciesHabits2 <- subset(SpeciesHabits2, select = -a)
}
NA_Floramerge <- unique(
merge(NA_Flora[,c('Scientific.Name','HabitSymbol')],
SpeciesHabits[,c('split','habit')], by.x='Scientific.Name', by.y = 'split', all.x = TRUE)
)
NA_Floramerge$HabitSymbol <- as.character(NA_Floramerge$HabitSymbol)
filtermerged <- subset(NA_Floramerge, !is.na(NA_Floramerge$habit))
2+2
2*7
(2*7)^5
x = 2
y = 4
z = x + y
z
x = 2
y = 5
a = "Dog"
b = "Cat"
c = "Dog"
a == "Dog"
a == b
c == a
c == b
if (a == b){"Hello World"}
if (a == b) "Hello World" else "good bye"
if (a == c) "Hello World" else "good bye"
if (a != c) "Hello World" else "good bye"
View(NA_Flora)
NA_Flora$HabitSymbol[2]
NA_Flora[2,2]
#ugfjhgvjhg
NA_Flora[5,1]
plot(5, 4)
library(stringr)
####----
Species <- read.delim("acuatica.txt", encoding = 'UTF-8')
Species$habit <- 'H.A'
SpeciesHabits <- Species
Species<- read.delim("arbolito.txt", encoding = 'UTF-8')
Species$habit <- 'T1'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("arbols.txt", encoding = 'UTF-8')
Species$habit <- 'T2'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("arbusto.txt", encoding = 'UTF-8')
Species$habit <- 'S2'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("bejuco.txt", encoding = 'UTF-8')
Species$habit <- 'L'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("epifito.txt", encoding = 'UTF-8')
Species$habit <- 'E.F'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("hemiepifito.txt", encoding = 'UTF-8')
Species$habit <- 'E.hemi'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("hierba.txt", encoding = 'UTF-8')
Species$habit <- 'H'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("parasito.txt", encoding = 'UTF-8')
Species$habit <- '.i'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("subarbusto.txt", encoding = 'UTF-8')
Species$habit <- 'S1'
SpeciesHabits <- rbind(SpeciesHabits, Species)
Species<- read.delim("suculento.txt", encoding = 'UTF-8')
Species$habit <- '.U'
SpeciesHabits <- rbind(SpeciesHabits, Species)
#Species<- read.delim("terrestre.txt", encoding = 'UTF-8')
#Species$habit <- '.terrestre'
#SpeciesHabits <- rbind(SpeciesHabits, Species)
#Species<- read.delim("trepadora.txt", encoding = 'UTF-8')
#Species$habit <- 'L.trailing'
#SpeciesHabits <- rbind(SpeciesHabits, Species)
####----
NA_Flora <- read.delim("NA_Flora.txt", encoding = 'UTF-8')
Habit_Symbols <- read.delim("Habit_Symbols.txt", encoding = 'UTF-8')
SpeciesHabits$split <- paste(str_split_fixed(SpeciesHabits$Name, " ",3)[,1],str_split_fixed(SpeciesHabits$Name , " ",3)[,2])
SpeciesHabits$auth <- str_split_fixed(SpeciesHabits$Name, " ",3)[,3]
SpeciesHabits$second <- str_split_fixed(SpeciesHabits$Name , " ",3)[,2]
SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1)) == substr(SpeciesHabits$second,1,1),]$split <-
str_split_fixed(SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1))
== substr(SpeciesHabits$second,1,1),]$Name, " ",3)[,1]
SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1)) == substr(SpeciesHabits$second,1,1),]$auth <-
str_split_fixed(SpeciesHabits[toupper(substr(SpeciesHabits$second,1,1)) == substr(SpeciesHabits$second,1,1),]$
Name, " ",2)[,2]
SpeciesHabits[SpeciesHabits$second == '×',]$split <-
paste(str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name, " ",4)[,1],
str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name , " ",4)[,2],
str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name, " ",4)[,3])
SpeciesHabits[SpeciesHabits$second == '×',]$auth <-
str_split_fixed(SpeciesHabits[SpeciesHabits$second == '×',]$Name, " ",4)[,4]
SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$split <-
paste(str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name, " ",5)[,1],
str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name , " ",5)[,2],
str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name , " ",5)[,3],
str_split_fixed(SpeciesHabits[grepl(' subsp\\. ',SpeciesHabits$Name),]$Name , " ",5)[,4])
SpeciesHabits[grepl('sp\\.',SpeciesHabits$Name),]$auth <-
str_split_fixed(SpeciesHabits[grepl('sp\\.',SpeciesHabits$Name),]$Name, " ",5)[,5]
SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$split <-
paste(str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name, " ",5)[,1],
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name , " ",5)[,2],
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name , " ",5)[,3],
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name , " ",5)[,4])
SpeciesHabits[grepl(' var\\.',SpeciesHabits$Name),]$auth <-
str_split_fixed(SpeciesHabits[grepl(' var\\. ',SpeciesHabits$Name),]$Name, " ",5)[,5]
####----Crosstab
SpeciesHabits$a <- 1
SpeciesHabits2 <- unique(SpeciesHabits[,c('split','auth')])
forma <- unique(SpeciesHabits$habit)
for (i in 1:length(forma)){
SpeciesHabits2 <- merge(SpeciesHabits2, SpeciesHabits[SpeciesHabits$habit %in% forma[i],c('split','auth','a')], by=c('split','auth'), all.x = TRUE)
SpeciesHabits2$new <- 0
SpeciesHabits2[!is.na(SpeciesHabits2$a),]$new <- 1
colnames(SpeciesHabits2)[colnames(SpeciesHabits2)=="new"] <- forma[i]
SpeciesHabits2 <- subset(SpeciesHabits2, select = -a)
}
NA_Floramerge <- unique(
merge(NA_Flora[,c('Scientific.Name','HabitSymbol')],
SpeciesHabits[,c('split','habit')], by.x='Scientific.Name', by.y = 'split', all.x = TRUE)
)
NA_Floramerge$HabitSymbol <- as.character(NA_Floramerge$HabitSymbol)
filtermerged <- subset(NA_Floramerge, !is.na(NA_Floramerge$habit))
require(sp)
require(raster)
require(rgdal)
require(rms)
require(RODBC)
#cluster analysis packages
library(vegan)
library(cluster)
library(ape)
#color pallette
library(RColorBrewer)
library(colorspace)
# Create a scatter plot matrix
library(ggplot2)
#calculate percentiles
library(plyr)
#classification tree packages
library(randomForest)
library(rpart)
library(rpart.plot)
#Discriminate Analysis
library(MASS)
#wt sd
library(Hmisc)
ptstab <- read.delim("data/pts10k.txt")
subalpinespp <- read.delim("data/subalpinespp.txt")
halophytespp <- read.delim("data/halophytespp.txt")
speciesfips<-read.delim("data/SpeciesFips2014.txt")
#County_Fips<-read.delim("data/County_Fips.txt")
path = 'C:/a/geo/model/global/'
Tw <- raster(paste0(path, 'Tw.tif'))
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
View(Tw)
library(stringr)
library(sf)
library(raster)
library(sp)
require(rgdal)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
statesf <- readRDS(file='data/statesf.RDS')
proj(Tw)
proj4string(Tw)
res(Tw)
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
View(fips_sf)
fips_sfna <- subset(fips_sf, !GROUP %in% 'South America')
plot(fips_sfna)
plot(fips_sfna$GROUP)
st_proj_info(fips_sfna)
fips_sfnarepro <- st_proj_info(fips_sfna,
CRS("+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0
datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0 "))
st_crs(Tw)
fips_sfnarepro <- st_transform(fips_sfna, st_crs(Tw))
plot(fips_sfnarepro )
plot(fips_sfnarepro[1])
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Berbuda','Hawaii' ))
#preproject
fips_sfnarepro <- st_transform(fips_sfna, st_crs(Tw))
plot(fips_sfnarepro[1])
fips_sfna <- subset(fips_sf, GROUP %in% c('South America', 'Bermuda','Hawaii' ))
#preproject
fips_sfnarepro <- st_transform(fips_sfna, st_crs(Tw))
plot(fips_sfnarepro[1])
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Bermuda','Hawaii' ))
#preproject
fips_sfnarepro <- st_transform(fips_sfna, st_crs(Tw))
plot(fips_sfnarepro[1])
namap <- st_rasterize(fips_sfnarepro, Tw, field="GROUP", fun='last', background=NA)
install.packages("st_rasterize")
install.packages("stars")
install.packages(c("prodlim", "RcppEigen", "rms", "scales"))
library(stringr)
library(sf)
library(raster)
library(rgdal)
library(st_rasterize)
library(stars)
tif = system.file((paste0(path, 'Tw.tif')), package = "stars")
Tw = read_stars(tif)
plot(Tw)
path = 'C:/workspace2/treeatlas/nam5k/'
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
tif = system.file((paste0(path, 'Tw.tif')), package = "stars")
Tw2 = read_stars(tif)
plot(Tw2)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
tif = system.file((paste0(path, 'Tw.tif')), package = "stars")
Tw2 = read_stars(tif)
plot(Tw2)
(paste0(path, 'Tw.tif'))
tif = system.file((paste0(path, 'Tw.tif')), package = "stars")
Tw2 = read_stars(tif)
read_stars
Tw2 = read_stars(tif)
tif
tif = system.file((paste0(path, 'Tw.tif')), package = "stars")
tif
tif = system.file(paste0(path, 'Tw.tif'), package = "stars")
tif
Tw2 = read_stars(tif)
tif = system.file('C:/workspace2/treeatlas/nam5k/Tw.tif', package = "stars")
tif
Tw2 = read_stars(tif)
Tw2 = read_stars(system.file('C:/workspace2/treeatlas/nam5k/Tw.tif', package = "stars"))
paste0(path, 'Tw.tif')
tif = system.file(paste0(path, 'Tw.tif'), package = "stars", mustWork = TRUE)
Tw2 = read_stars(tif)
tif = system.file(paste0(path, 'Tw.tif'), package = "stars", mustWork = FALSE)
Tw2 = read_stars(tif)
tif = system.file(paste0(path, 'Tw.tif'), package = "Stars")
Tw2 = read_stars(tif)
path
tif = system.file(paste0(path, 'Tw.tif'), package = "stars")
Tw2 = read_stars(tif)
tif = system.file(paste0(path, 'Tw.tif'))
Tw2 = read_stars(tif)
View(Tw)
View(Tw)
library(stars)
tif = system.file(paste0(path, 'Tw.tif'), package = "stars")
Tw2 = read_stars(tif)
286.74*52
286.74*26
146.24*26
7455.24-3802.24
3600/20
20-7.5
3600/12.5
75-30
3600/45
library(stringr)
library(sf)
library(raster)
library(rgdal)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
xy <- selectfips[,c('x','y')]
library(stringr)
library(sf)
library(raster)
library(rgdal)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
library(stringr)
library(sf)
library(raster)
library(rgdal)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
fips_sf$GROUP <- st_read('C:/a/geo/base/americas4.shp')
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Bermuda','Hawaii' ))
View(fips_sfna)
install.packages("rasterize")
library(rasterize)
install.packages("fasterize")
library(fasterize)
narast <- fasterize(fips_sfna, Tw, field = 'Group')
narast <- fasterize(fips_sfna, Tw, field = 'GROUP')
View(narast)
plot(narast)
narast <- fasterize(fips_sfna, Tw)
plot(narast)
plot(narast$layer)
narast$layer
narast
View(fips_sf)
narast <- fasterize(fips_sfna, Tw, field = 'ID')
plot(narast)
narast <- rasterize(fips_sfna, Tw, field = 'ID')
library(stringr)
library(sf)
library(raster)
library(rgdal)
library(fasterize)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
# make spatial dataframe ----------------------------------------------------------
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Bermuda','Hawaii' ))
narast <- rasterize(fips_sfna, Tw, field = 'ID')
plot(narast)
library(raster)
library(fasterize)
library(sf)
p1 <- rbind(c(-180,-20), c(-140,55), c(10, 0), c(-140,-60), c(-180,-20))
hole <- rbind(c(-150,-20), c(-100,-10), c(-110,20), c(-150,-20))
p1 <- list(p1, hole)
p2 <- list(rbind(c(-10,0), c(140,60), c(160,0), c(140,-55), c(-10,0)))
p3 <- list(rbind(c(-125,0), c(0,60), c(40,5), c(15,-45), c(-125,0)))
pols <- st_sf(value = c(1,2,3),
geometry = st_sfc(lapply(list(p1, p2, p3), st_polygon)))
r <- raster(pols, res = 1)
r <- fasterize(pols, r, field = "value", fun="sum")
plot(r)
library(raster)
library(fasterize)
library(sf)
p1 <- rbind(c(-180,-20), c(-140,55), c(10, 0), c(-140,-60), c(-180,-20))
hole <- rbind(c(-150,-20), c(-100,-10), c(-110,20), c(-150,-20))
p1 <- list(p1, hole)
p2 <- list(rbind(c(-10,0), c(140,60), c(160,0), c(140,-55), c(-10,0)))
p3 <- list(rbind(c(-125,0), c(0,60), c(40,5), c(15,-45), c(-125,0)))
pols <- st_sf(value = c(1,2,3),
geometry = st_sfc(lapply(list(p1, p2, p3), st_polygon)))
View(pols)
View(p3)
View(p2)
View(p1)
View(hole)
plot(pols)
View(p1)
View(p2)
View(pols)
p1 <- rbind(c(-180,-20), c(-140,56), c(10, 0), c(-140,-60), c(-180,-20))
hole <- rbind(c(-150,-20), c(-100,-10), c(-110,20), c(-150,-20))
p1 <- list(p1, hole)
p2 <- list(rbind(c(-10,0), c(140,60), c(160,0), c(140,-55), c(-10,0)))
p3 <- list(rbind(c(-125,0), c(0,60), c(40,5), c(15,-45), c(-125,0)))
pols <- st_sf(value = c(1,2,3),
geometry = st_sfc(lapply(list(p1, p2, p3), st_polygon)))
r <- raster(pols, res = 1)
r <- fasterize(pols, r, field = "value", fun="sum")
plot(pols)
r <- raster(pols, res = 1)
plot(r)
r <- raster(pols, res = 1)
plot(r)
r <- fasterize(pols, r, field = "value", fun="sum")
plot(r)
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Bermuda','Hawaii' ))
narast <- fasterize(fips_sfna, Tw, field = 'ID')
plot(narast)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
# make spatial dataframe ----------------------------------------------------------
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Bermuda','Hawaii' ))
narast <- fasterize(fips_sfna, Tw, field = 'ID')
plot(narast)
View(fips_sfna)
narast <- fasterize(fips_sfna, Tw, field = 'ID', fun = "last")
plot(narast)
narast <- fasterize(fips_sfna, Tw, field = 'ID', fun = "sum")
plot(narast)
fips_sfna$ID <- as.numeric(fips_sfna$ID)
narast <- fasterize(fips_sfna, Tw, field = 'ID', fun = "sum")
plot(narast)
plot(fips_sfna)
fip_sfna <- project(fips_sfna, TW)
fip_sfna <- st_transform(fips_sfna, TW)
path = 'C:/workspace2/treeatlas/nam5k/'
Tw <- raster(paste0(path, 'Tw.tif'))
res(Tw)
fip_sfna <- st_transform(fips_sfna, TW)
crs(Tw)
fip_sfna <- st_transform(fips_sfna, Tw)
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Bermuda','Hawaii' ))
fips_sfna$ID <- as.numeric(fips_sfna$ID)
narast <- fasterize(fips_sfna, Tw, field = 'ID', fun = "sum")
fip_sfna1 <- st_transform(fips_sfna, Tw)
fip_sfna1 <- st_transform(fips_sfna, crs(Tw))
plot(fip_sfna1)
narast <- fasterize(fip_sfna1, Tw, field = 'ID', fun = "sum")
plot(narast)
narast <- fasterize(fip_sfna1, Tw)
plot(narast)
narast <- fasterize(fip_sfna1, Tw, field = 'ID', fun = "sum")
plot(narast)
points1 <- rasterToPoints(narast)
View(points1)
points1 <- rasterToPoints(Tw)
View(points1)
str(points1)
class(points1)
points1 <- as.data.frame(rasterToPoints(Tw))
class(points1)
str(points1)
View(points1)
nrow(points1)
nrow(unique(points1))
nrow(unique(points1[,1:2]))
narast <- fasterize(fip_sfna1, Tw, field = 'ID', fun = "last")
points2 <- as.data.frame(rasterToPoints(narast))
View(points2)
points2 <- merge(points2, fips_sfna, by.x='layer',by.y='ID')
View(points2)
points2 <- as.data.frame(rasterToPoints(narast))
points2 <- merge(points2, fips_sfna[,c('ID','FIPS')], by.x='layer',by.y='ID')
View(points2)
points2 <- merge(points2, st_drop_geometry(fips_sfna[,c('ID','FIPS')]), by.x='layer',by.y='ID', all.x = TRUE)
View(points2)
fips_sf <- st_read('C:/a/geo/base/americas4.shp')
fips_sfna <- subset(fips_sf, !GROUP %in% c('South America', 'Bermuda','Hawaii' ))
fips_sfna$ID <- as.numeric(fips_sfna$ID)
fip_sfna1 <- st_transform(fips_sfna, crs(Tw))
narast <- fasterize(fip_sfna1, Tw, field = 'ID', fun = "last")
plot(narast)
points1 <- as.data.frame(rasterToPoints(Tw))
points2 <- as.data.frame(rasterToPoints(narast))
points2 <- merge(points2, st_drop_geometry(fips_sfna[,c('ID','FIPS')]), by.x='layer',by.y='ID', all.x = TRUE)
View(points2)
points3 <- merge(points1, points2, by=c('x','y'))
View(points3)
